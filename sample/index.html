<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Currency Input (Minimal)</title>
<style>
  .currency-input {
    position: relative;
    max-width: 280px;
  }
  .currency-input::before {
    content: attr(data-symbol);
    position: absolute;
    left: 12px;
    top: 50%;
    transform: translateY(-50%);
    pointer-events: none;
    opacity: 0.75;
    font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, sans-serif;
  }
  .currency-input > input {
    width: 100%;
    box-sizing: border-box;
    padding: 10px 12px 10px 34px; /* leave room for symbol */
    border: 1px solid #cfd4dc;
    border-radius: 10px;
    font-size: 16px;
    outline: none;
  }
  .currency-input > input:focus {
    border-color: #7aa2ff;
    box-shadow: 0 0 0 3px rgba(122,162,255,.15);
  }
</style>
</head>
<body>

<form id="money-form">
  <!-- Change the symbol here -->
  <label class="currency-input" data-symbol="â‚¦">
    <input id="amount" name="amount_display" inputmode="decimal" autocomplete="off" placeholder="0" />
  </label>

  <!-- Raw numeric value (no commas, optional if you need a clean value on submit) -->
  <input type="hidden" id="amount_raw" name="amount" />
</form>

<script>
  (function () {
    const input = document.getElementById('amount');
    const hidden = document.getElementById('amount_raw');
    const maxDecimals = 2; // set to 0 if you want whole numbers only

    function formatWithCommas(value) {
      // keep only digits and a single dot
      value = value.replace(/[^\d.]/g, '');
      const parts = value.split('.');
      let intPart = parts[0].replace(/^0+(?=\d)/, ''); // strip leading zeros (but keep single 0)
      if (intPart === '') intPart = '0';
      // group thousands
      intPart = intPart.replace(/\B(?=(\d{3})+(?!\d))/g, ',');
      // decimals
      let decPart = parts[1] ? parts[1].slice(0, maxDecimals) : '';
      return decPart ? intPart + '.' + decPart : intPart;
    }

    function rawNumber(value) {
      // remove commas; keep up to one dot
      const cleaned = value.replace(/,/g, '');
      return cleaned;
    }

    input.addEventListener('input', function (e) {
      const formatted = formatWithCommas(e.target.value);
      // set value and move caret to end (simple + stable)
      e.target.value = formatted;
      const end = e.target.value.length;
      e.target.setSelectionRange(end, end);
      if (hidden) hidden.value = rawNumber(formatted);
    });

    input.addEventListener('blur', function (e) {
      // optionally pad to 2 decimals on blur:
      const v = rawNumber(e.target.value);
      if (!v) return;
      if (maxDecimals > 0) {
        const n = Number(v);
        if (!isNaN(n)) {
          const fixed = n.toFixed(maxDecimals);
          e.target.value = formatWithCommas(fixed);
          if (hidden) hidden.value = fixed;
        }
      } else {
        if (hidden) hidden.value = rawNumber(e.target.value);
      }
    });
  })();
</script>

</body>
</html>
